# Codex Agent Swarms Tutorial

A beginner-friendly, end-to-end guide for using Agent Swarms skills in Codex. You will plan a feature with `swarm-planner`, then execute it in parallel waves with `parallel-task`, and learn how `context7` keeps library documentation current.

## Prerequisites

- Codex installed and working
- Skills installed under `~/.codex/skills/`
- Optional: a Context7 API key if you want live library docs
- Plan Mode available in Codex (recommended)

## Install Skills (Codex)

From this repo (or a copy of its `skills/` directory), install the three skills:

```bash
cp -r skills/swarm-planner ~/.codex/skills/
cp -r skills/parallel-task ~/.codex/skills/
cp -r skills/context7 ~/.codex/skills/
```

Optional: enable Context7 locally

```bash
cp skills/context7/.env.example .env
set -a; source .env; set +a
```

Quick verification checklist:

- `~/.codex/skills/swarm-planner/SKILL.md` exists
- `~/.codex/skills/parallel-task/SKILL.md` exists
- `~/.codex/skills/context7/SKILL.md` exists

## The Two-Phase Workflow

**Phase 1: Planning** (with `swarm-planner`)
- Researches your codebase
- Fetches library docs with Context7
- Asks clarifying questions
- Produces a dependency-aware plan

**Phase 2: Execution** (with `parallel-task`)
- Reads the plan
- Launches subagents in parallel waves
- Updates the plan as tasks complete
- Verifies work between waves

## Walkthrough Example: Add Auth to an Express App

This example uses a typical backend feature: adding authentication to an Express app. You will plan the work first, then execute it.

### Step 1: Enter Plan Mode

In Codex:

1. Switch to Plan Mode
2. Provide your prompt and invoke the skill

Example prompt:

```
Use the swarm-planner skill to add JWT-based authentication to my Express app.
```

### Step 2: Answer Clarifying Questions

`swarm-planner` will ask questions when there are choices to make. Example:

- JWT vs session-based auth
- Token storage (cookies vs local storage)
- Password hashing library (bcrypt vs argon2)

Answer these to lock in scope. If you are unsure, choose the recommended option it presents.

### Step 3: Review the Generated Plan

The planner saves a file like:

```
<topic>-plan.md
```

The plan includes tasks with explicit dependencies so work can run in parallel. Each task looks like this:

```markdown
### T1: Create User Model
- **depends_on**: []
- **location**: src/models/user.ts
- **description**: Define the User entity with required fields
- **validation**: Unit tests pass
- **status**: Not Completed
- **log**: 
- **files edited/created**:
```

Key fields to understand:

- `depends_on`: tasks that must finish first
- `location`: files and folders to edit
- `validation`: how to verify the task
- `status` / `log` / `files`: updated by subagents as they complete work

Plans also include a dependency graph and a wave table to show which tasks can run in parallel.

### Step 4: Execute the Plan

Switch out of Plan Mode (Shift+Tab in Codex), then run the execution skill:

```
Run the plan with the parallel task skill
```

Or specify the plan file directly:

```
/parallel-task auth-plan.md
```

The orchestrator will:

- Launch all unblocked tasks in parallel (Wave 1)
- Validate results
- Move to the next wave once dependencies are satisfied

During execution, each subagent updates the plan file with:

- Completion status
- Work log
- Files edited/created

### Step 5: Verify Results

After execution completes:

- Open the plan file and confirm all tasks show `Completed`
- Review logs for any warnings or deferred validations
- Run project tests if they were deferred during execution

## Troubleshooting

**Plan file not found**
- Ensure the plan file is in your current working directory
- Verify the filename matches the one generated by `swarm-planner`

**Context7 docs not loading**
- Confirm `CONTEXT7_API_KEY` is set in your environment
- Run `set -a; source .env; set +a` if using a local `.env`

**Execution is stuck**
- Check that all tasks have correct `depends_on` values
- Look for missing or incorrect task IDs

**Skill invocation issues**
- Verify skill directories exist under `~/.codex/skills/`
- Re-check skill names: `swarm-planner`, `parallel-task`, `context7`

## Appendix

Example dependency graph:

```
T1 ──┬── T3 ──┐
     │        ├── T5 ── T6
T2 ──┴── T4 ──┘
```

Example wave table:

| Wave | Tasks | Can Start When |
|------|-------|----------------|
| 1 | T1, T2 | Immediately |
| 2 | T3, T4 | Wave 1 complete |
| 3 | T5 | T3, T4 complete |
| 4 | T6 | T2, T5 complete |

Recommended next steps:

- Use the same workflow for a feature in your own repo
- Keep plan files versioned so you can audit progress
- Add more tasks to the plan if you discover new requirements during execution
